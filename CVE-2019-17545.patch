From 0a13edea987dd0571df001e4ff1382ee714b1848 Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@spatialys.com>
Date: Mon, 14 Oct 2019 20:35:44 -0700
Subject: [PATCH] OGRExpatRealloc(): fix double-free when size to allocate is
 above the default 10MB threshold. Fixes

https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16178. Credit to
 OSS Fuzz
---
 ogr/ogr_expat.cpp | 1 -
 1 file changed, 1 deletion(-)

diff --git a/ogr/ogr_expat.cpp b/ogr/ogr_expat.cpp
index 71b271c..de7d29d 100644
--- a/ogr/ogr_expat.cpp
+++ b/ogr/ogr_expat.cpp
@@ -73,7 +73,6 @@ static void* OGRExpatRealloc( void *ptr, size_t size )
     CPLError(CE_Failure, CPLE_OutOfMemory,
              "Expat tried to realloc %d bytes. File probably corrupted",
              static_cast<int>(size));
-    free(ptr);
     return NULL;
 }
 
-- 
2.23.0

